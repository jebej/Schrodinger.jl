<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The Driven Two-Level System · Schrodinger.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">Schrodinger.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../man/gettingstarted.html">Getting Started</a></li><li><a class="tocitem" href="../man/quantumobjects.html">Quantum Objects</a></li><li><a class="tocitem" href="../man/working.html">Working with States and Operators</a></li><li><a class="tocitem" href="../man/dynamics.html">Time Evolution and Dynamics</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href="driven_TLS.html">The Driven Two-Level System</a><ul class="internal"><li><a class="tocitem" href="#The-Hamiltonian"><span>The Hamiltonian</span></a></li><li><a class="tocitem" href="#Numerics"><span>Numerics</span></a></li><li><a class="tocitem" href="#Derivation"><span>Derivation</span></a></li><li><a class="tocitem" href="#Comparison"><span>Comparison</span></a></li><li><a class="tocitem" href="#Chevron-Pattern"><span>Chevron Pattern</span></a></li></ul></li><li><a class="tocitem" href="DRAG.html">DRAG</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../api/quobj.html">Quantum Object Types</a></li><li><a class="tocitem" href="../api/states.html">State Library</a></li><li><a class="tocitem" href="../api/operators.html">Operator Library</a></li><li><a class="tocitem" href="../api/functions.html">Function Library</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="driven_TLS.html">The Driven Two-Level System</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="driven_TLS.html">The Driven Two-Level System</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jebej/Schrodinger.jl/blob/master/docs/src/examples/driven_TLS.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-Driven-Two-Level-System"><a class="docs-heading-anchor" href="#The-Driven-Two-Level-System">The Driven Two-Level System</a><a id="The-Driven-Two-Level-System-1"></a><a class="docs-heading-anchor-permalink" href="#The-Driven-Two-Level-System" title="Permalink"></a></h1><p>The driven two-level system (TLS) is one of the very few non-trivial time dependent problem whose dynamics can be solved for analytically. As such it provides a good benchmark for numerical solvers, since we can easily quantify their performance.</p><h2 id="The-Hamiltonian"><a class="docs-heading-anchor" href="#The-Hamiltonian">The Hamiltonian</a><a id="The-Hamiltonian-1"></a><a class="docs-heading-anchor-permalink" href="#The-Hamiltonian" title="Permalink"></a></h2><p>The Hamiltonian of a two-level system is usually expressed with a <span>$\hat{σ}_z$</span> Pauli operator, but for simplicity, we use a normal number operator, which we multiply by the frequency of the transition between the ground state and the excited state: <span>$\hat{H}_0 = \hbar ω \hat{n}$</span>.</p><p>The drive consists of an oscillating field in a direction transverse to the TLS. We use a circularly polarized field, meaning that the component of the drive for the <span>$g \rightarrow w$</span> transition is complex and is the complex conjugate of the component of the drive for the <span>$w \rightarrow g$</span> transition. Explicitly, if the drive has strength <span>$\gamma$</span> (in angular frequency units), the drive operator is:</p><p class="math-container">\[\begin{aligned}
\hat{H}_d = \hbar \gamma \begin{pmatrix}
0 &amp; e^{i \omega_d t} \\
e^{-i \omega_d t} &amp; 0
\end{pmatrix},
\end{aligned}\]</p><p>where <span>$\omega_d$</span> is the drive frequency.</p><p>Note that if the driving field is not circularly polarized, for example if the drive is <span>$\hbar \gamma \hat{\sigma}_x \cos(\omega_d t)$</span> (corresponding to linear polarization), the dynamics of the system are no longer solvable analytically.</p><h2 id="Numerics"><a class="docs-heading-anchor" href="#Numerics">Numerics</a><a id="Numerics-1"></a><a class="docs-heading-anchor-permalink" href="#Numerics" title="Permalink"></a></h2><p>Before starting the mathematical derivation, let&#39;s let the computer solve the problem for us:</p><pre><code class="language-julia hljs">using Schrodinger, PyPlot

# frequencies, starting state and number operator
ω = 1*2π
ωd = 0.9*2π
γ = π/2
g = basis(2,0)
n = numberop(2)

# drive function, p[1] is the frequency and p[2] is the drive strength
fd = (t,p) -&gt; p[2]*cis(p[1]*t)

# solve it! we use a drive strength of γ (in angular frequency units)
# note the negative frequency for circular polarization
r1 = sesolve((ω*n, (σ₋,fd,[ωd,γ]), (σ₊,fd,[-ωd,γ])), g, (0.0,3.0), saveat=0.01)

plot(r1.times,levelprobs(r1.states)); grid();
xlabel(&quot;Time&quot;); ylabel(&quot;Level Probabilities&quot;);
legend([&quot;|g⟩&quot;, &quot;|e⟩&quot;]);</code></pre><p><img src="img/driven_TLS_1.svg" alt="driven_TLS_1"/></p><p>Notice that we chose a drive frequency below that of the TLS frequency. This results in a TLS oscillation frequency <em>higher</em> than π (the drive strength), however, the excited state never gets fully occupied.</p><h2 id="Derivation"><a class="docs-heading-anchor" href="#Derivation">Derivation</a><a id="Derivation-1"></a><a class="docs-heading-anchor-permalink" href="#Derivation" title="Permalink"></a></h2><p>We now derive the dynamics of the system analytically, so that we may verify our numerics.</p><p>First, we move to the interaction picture in order to ignore the precession about the z-axis. We are thus left only with <span>$\hat{H}_I = e^{i \hat{H}_0 t / \hbar} \hat{H}_D e^{-i \hat{H}_0 t / \hbar}$</span>. For a state with time dependent coefficients <span>$c_0$</span> and <span>$c_1$</span>, the Schrödinger equation thus reads:</p><p class="math-container">\[\begin{aligned}
i \hbar \dot{|\psi\rangle}_I &amp;= \hat{H}_I |\psi\rangle_I, \\
i \hbar \begin{pmatrix} \dot{c}_0 \\ \dot{c}_1 \end{pmatrix} &amp;= \hbar \gamma \begin{pmatrix} 0 &amp; e^{i \Delta\omega t} \\ e^{-i \Delta\omega t} &amp; 0 \end{pmatrix} \begin{pmatrix} c_0 \\ c_1 \end{pmatrix}, \\
 &amp;= \hbar \gamma \begin{pmatrix} e^{i \Delta\omega t} c_1 \\ e^{-i \Delta\omega t} c_0 \end{pmatrix},
\end{aligned}\]</p><p>where <span>$\Delta\omega = \omega_d - \omega$</span>.</p><p>We thus have a system of coupled differential equations to solve, with initial condition <span>$c_0(t=0) = 1$</span> and normalization <span>$|c_0|^2 + |c_1|^2 = 1$</span>. We first decouple the system by isolating <span>$c_0(t)$</span> in the second equation, differentiating it and inserting the result in the second equation:</p><p class="math-container">\[\begin{aligned}
c_0(t) &amp;= i/\gamma  e^{i \Delta\omega t} \dot{c}_1, \\
\dot{c}_0(t) &amp;= i/\gamma  \left( e^{i \Delta\omega t} \ddot{c}_1 + i \Delta\omega e^{i \Delta\omega t} \dot{c}_1 \right),
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
-1/\gamma  \left( e^{i \Delta\omega t} \ddot{c}_1 + i \Delta\omega e^{i \Delta\omega t} \dot{c}_1 \right) &amp;= \gamma  e^{i \Delta\omega t} c_1, \\
e^{i \Delta\omega t} \ddot{c}_1 + i \Delta\omega e^{i \Delta\omega t} \dot{c}_1 &amp;= -\gamma^2  e^{i \Delta\omega t} c_1.
\end{aligned}\]</p><p>Finally, since the equation must be valid for all <span>$t$</span>, we drop the exponential to obtain a homogeneous second order differential equation:</p><p class="math-container">\[\ddot{c}_1 + i \Delta\omega \dot{c}_1 + \gamma^2 c_1 = 0.\]</p><p>At this point we guess a solution <span>$c_1(t) \propto e^{i \alpha t}$</span> which, when inserted in the differential equation, gives a 2nd order polynomial in <span>$\alpha$</span>:</p><p class="math-container">\[\begin{aligned}
-\alpha^2 c_1 + i \Delta\omega i \alpha c_1 + \gamma^2 c_1 &amp;= 0, \\
\alpha^2 + \Delta\omega \alpha - \gamma^2 &amp;= 0,
\end{aligned}\]</p><p>with solutions</p><p class="math-container">\[\begin{aligned}
\alpha_\pm &amp;= - \Delta\omega/2 \pm \sqrt{ ( \Delta\omega/2 )^2 + \gamma^2 }, \\
           &amp;= - \Delta\omega/2 \pm \Omega,
\end{aligned}\]</p><p>where we have introduced the well know <em>Rabi frequency</em> <span>$\Omega = \sqrt{ ( \Delta\omega/2 )^2 + \gamma^2 }$</span>.</p><p>As expected, a second order differential equation gives us two solutions, with which we form the general solution:</p><p class="math-container">\[c_1(t) = a e^{-i \Delta\omega t /2} e^{i \Omega t} + b e^{-i \Delta\omega t /2} e^{-i \Omega t}.\]</p><p>We can eliminate <span>$b$</span> by using the initial condition <span>$c_1(t=0) = 0$</span>, giving us <span>$b = -a$</span>. This allows us to simplify the general solution:</p><p class="math-container">\[c_1(t) = a e^{-i \Delta\omega t /2} 2i \sin(\Omega t) = c e^{-i \Delta\omega t /2} \sin(\Omega t).\]</p><p>Finally, to determine the value of <span>$a$</span>, we insert the general solution back in the original differential equation for <span>$c_1(t)$</span> and make use of the normalization property:</p><p class="math-container">\[\begin{aligned}
\dot{c_1} &amp;= c ( -i \Delta\omega/2 e^{-i \Delta\omega t /2} \sin(\Omega t) + \Omega e^{-i \Delta\omega t /2} \cos(\Omega t) ), \\
          &amp;= \gamma e^{-i \Delta\omega t} c_0
\end{aligned}\]</p><p>equating the equations and taking the absolute square:</p><p class="math-container">\[\begin{aligned}
e^{-i \Delta\omega t /2} c ( -i \Delta\omega/2 \sin(\Omega t) + \Omega \cos(\Omega t) ) &amp;= \gamma e^{-i \Delta\omega t} c_0, \\
|c|^2 ( (\Delta\omega/2)^2 \sin^2(\Omega t) + \Omega^2 \cos^2(\Omega t) ) &amp;= \gamma^2 |c_0|^2 = \gamma^2 ( 1 - |c_1|^2 ), \\
|c|^2 ( (\Delta\omega/2)^2 \sin^2(\Omega t) + \Omega^2 \cos^2(\Omega t) + \gamma^2 \sin^2(\Omega t) )&amp;= \gamma^2, \\
|c|^2 ( \Omega^2 \sin^2(\Omega t) + \Omega^2 \cos^2(\Omega t) )&amp;= \gamma^2, \\
|c|^2 \Omega^2 &amp;= \gamma^2, \\
|c|^2 &amp;= \gamma^2 / \Omega^2.
\end{aligned}\]</p><p>The final solution for <span>$c_1(t)$</span> then, up to a constant global phase is:</p><p class="math-container">\[c_1(t) = \gamma / \Omega e^{-i \Delta\omega t /2} \sin(\Omega t).\]</p><p>This equation is quite interesting, and it perfectly explains the non-trivial behavior of the driven TLS. It shows the switching frequency, which is the much celebrated Rabi frequency, and also shows that the maximum transfer probability from the ground to excited state <span>$|c|^2$</span> is a Lorentzian with respect to <span>$\Delta\omega$</span>, the detuning between the drive and the TLS frequency:</p><p class="math-container">\[|c_1|^2_\text{max} = \frac{\gamma^2}{\gamma^2 + \left(\frac{\Delta\omega}{2}\right)^2}.\]</p><h2 id="Comparison"><a class="docs-heading-anchor" href="#Comparison">Comparison</a><a id="Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison" title="Permalink"></a></h2><p>In order to compare to the simulation done at the beginning, we simply write a function that computes <span>$c_1(t)$</span>, and plot the outpout against the one from <code>sesolve</code>.</p><pre><code class="language-julia hljs">c₁(t,γ,Δω) = (Ω = √(γ^2+(Δω/2)^2); γ/Ω * cis(-Δω/2*t) * sin(Ω*t))

Δω = ωd-ω
c1 = c₁.(r1.times,γ,Δω) # compute data for c₁
analytic = [1 .- abs2.(c1) abs2.(c1)] # 1-|c₁|² and |c₁|²

plot(r1.times,analytic)
legend([&quot;|g⟩&quot;, &quot;|e⟩&quot;, &quot;|g⟩ (analytic)&quot;, &quot;|e⟩ (analytic)&quot;]);</code></pre><p><img src="img/driven_TLS_2.svg" alt="driven_TLS_2"/></p><p>It worked! It is hard to tell that the two lines are on top of each other, but we can numerically compare the data:</p><pre><code class="language-julia hljs">analytic ≈ levelprobs(r1.states)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>We did omit a detail here: while we calculated <span>$c_1(t)$</span> in the interaction picture, our simulation was not done in the interaction picture. Instead, we gave the solver the full Hamiltonian. This discrepancy can be seen by comparing the actual amplitude <span>$c_1$</span>, instead of the probability <span>$|c_1|^2$</span>:</p><pre><code class="language-julia hljs">c1 ≈ 1im.*getindex.(r1.states,2) # second index for excited state</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>Note that computationally, it is much more advantageous to perform the simulation in the interaction picture since we avoid simulating the constant precession of the TLS around the z-axis.</p><pre><code class="language-julia hljs"># in the interaction picture
r2 = sesolve((qzero(2), (σ₋,fd,[Δω,γ]), (σ₊,fd,[-Δω,γ])), g, (0.0,3.0), saveat=0.01)

c1 ≈ 1im.*getindex.(r2.states,2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Visually, this can be understood by plotting the phase of the state as a function of time:</p><pre><code class="language-julia hljs">plot(r1.times, 180/π.*angle.(1im.*getindex.(r1.states,2)))
plot(r2.times, 180/π.*angle.(1im.*getindex.(r2.states,2)))
xlabel(&quot;Time&quot;); ylabel(&quot;∠c₁ (°)&quot;); grid()
legend([&quot;Schrödinger picture&quot;, &quot;Interaction picture&quot;]);</code></pre><p><img src="img/driven_TLS_3.svg" alt="driven_TLS_3"/></p><p>The phase is changing much more rapidly in the Schrödinger picture than in the interaction picture, and thus more points per unit time are required to obtain the same accuracy.</p><h2 id="Chevron-Pattern"><a class="docs-heading-anchor" href="#Chevron-Pattern">Chevron Pattern</a><a id="Chevron-Pattern-1"></a><a class="docs-heading-anchor-permalink" href="#Chevron-Pattern" title="Permalink"></a></h2><p>A cool experiment that can be done with qubits is to verify that the TLS dynamics hold over a range of driving frequencies. We drive a qubit at various frequencies and measure the excited state probability over time. This leads to a very nice &quot;chevron pattern&quot; plot:</p><pre><code class="language-julia hljs">t = 0:0.1:12
ωd_ratio = transpose(0.5:0.01:1.5)
chev = abs2.(c₁.(t,γ,ω.*ωd_ratio.-ω))
imshow(chev,origin=&quot;lower&quot;,extent=[0.5,1.5,0,12],aspect=1/15)
xlabel(&quot;\$ω_d/ω\$&quot;); ylabel(&quot;Time&quot;);</code></pre><p><img src="img/driven_TLS_4.svg" alt="driven_TLS_4"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../man/dynamics.html">« Time Evolution and Dynamics</a><a class="docs-footer-nextpage" href="DRAG.html">DRAG »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Sunday 21 August 2022 23:33">Sunday 21 August 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
